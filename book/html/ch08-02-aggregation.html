<!DOCTYPE HTML>
<html lang="en" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Demographic Analysis: Titanic Dataset - Ruchy REPL &amp; One-Liner Demos</title>


        <!-- Custom HTML head -->

        <meta name="description" content="Test-driven collection of Ruchy REPL sessions and one-liners - every example is tested">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="book/theme/ruchy.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "rust";
            const default_dark_theme = "coal";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Ruchy REPL &amp; One-Liner Demos</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/paiml/ruchy-repl-demos" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/paiml/ruchy-repl-demos/edit/main/book/src/ch08-02-aggregation.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="82-demographic-analysis-titanic-dataset"><a class="header" href="#82-demographic-analysis-titanic-dataset">8.2 Demographic Analysis: Titanic Dataset</a></h1>
<p><strong>Real-World Data Science: Understanding Survival Patterns</strong></p>
<p>The Titanic disaster dataset provides a compelling introduction to demographic analysis and survival prediction. With 891 passengers and rich categorical data (gender, class, age), it demonstrates how social factors influenced survival in history’s most famous maritime tragedy.</p>
<h2 id="what-youll-learn"><a class="header" href="#what-youll-learn">What You’ll Learn</a></h2>
<ul>
<li>Demographic pattern analysis (gender, class, age)</li>
<li>Survival rate calculations by groups</li>
<li>Cross-tabulation and comparative analysis</li>
<li>Feature engineering with social categories</li>
<li>Data-driven historical insights</li>
</ul>
<h2 id="the-dataset"><a class="header" href="#the-dataset">The Dataset</a></h2>
<pre><code class="language-ruchy">// Create Titanic dataset using DataFrame (production: df.from_csv())
let titanic_df = df![
    passenger_id =&gt; [1, 4, 7, 10, 12, 16, 3, 5, 8],
    survived =&gt; [1, 1, 0, 1, 1, 0, 1, 0, 0],
    pclass =&gt; [1, 1, 1, 2, 2, 2, 3, 3, 3],
    sex =&gt; ["female", "female", "male", "female", "female", "female", "female", "male", "male"],
    age =&gt; [38, 35, 54, 14, 58, 55, 26, 35, 2],
    fare =&gt; [71.28, 53.10, 51.86, 30.07, 26.55, 16.00, 7.92, 8.05, 21.08],
    embarked =&gt; ["C", "S", "S", "C", "S", "S", "S", "S", "S"]
];

println(f"Titanic DataFrame loaded: {titanic_df.height()} passengers");
println(f"Features: {titanic_df.width()} columns - passenger_id, survived, pclass, sex, age, fare, embarked");
</code></pre>
<h2 id="overall-survival-analysis"><a class="header" href="#overall-survival-analysis">Overall Survival Analysis</a></h2>
<p>Start with basic survival statistics:</p>
<pre><code class="language-ruchy">// Professional survival analysis using DataFrame operations
let survival_overview = titanic_df
    .agg([
        count("survived").alias("total_passengers"),
        sum("survived").alias("survivors"),
        (count("survived") - sum("survived")).alias("casualties"),
        (sum("survived").cast(Float64) / count("survived").cast(Float64) * 100.0).alias("survival_rate_pct")
    ]);

println("Titanic Disaster Overview (DataFrame Analysis):");
println(survival_overview);
</code></pre>
<p><strong>Historical Context:</strong> In our sample, 56% survived, but historically only 32% of all passengers survived.</p>
<h2 id="gender-analysis-women-and-children-first"><a class="header" href="#gender-analysis-women-and-children-first">Gender Analysis: “Women and Children First”</a></h2>
<p>Analyze the famous maritime protocol:</p>
<pre><code class="language-ruchy">// Professional gender analysis using DataFrame groupby
let gender_survival = titanic_df
    .groupby(["sex"])
    .agg([
        count("survived").alias("total_passengers"),
        sum("survived").alias("survivors"),
        (sum("survived").cast(Float64) / count("survived").cast(Float64) * 100.0).alias("survival_rate_pct")
    ])
    .sort("survival_rate_pct", descending: true);

println("Gender Survival Analysis (DataFrame):");
println(gender_survival);
</code></pre>
<p><strong>Historical Insight:</strong> The “women and children first” protocol was followed - women had dramatically higher survival rates.</p>
<h2 id="class-analysis-social-hierarchy-and-survival"><a class="header" href="#class-analysis-social-hierarchy-and-survival">Class Analysis: Social Hierarchy and Survival</a></h2>
<p>Examine how passenger class affected survival:</p>
<pre><code class="language-ruchy">// Professional class analysis using DataFrame operations
let class_survival = titanic_df
    .groupby(["pclass"])
    .agg([
        count("survived").alias("total_passengers"),
        sum("survived").alias("survivors"),
        (sum("survived").cast(Float64) / count("survived").cast(Float64) * 100.0).alias("survival_rate_pct"),
        mean("fare").alias("avg_fare")
    ])
    .sort("pclass");

println("Class Survival Analysis (DataFrame):");
println(class_survival);
</code></pre>
<p><strong>Social Insight:</strong> Higher passenger class correlated with better access to lifeboats and survival.</p>
<h2 id="age-demographics"><a class="header" href="#age-demographics">Age Demographics</a></h2>
<p>Analyze age patterns in survival:</p>
<pre><code class="language-ruchy">// Age-based survival analysis
let children = passengers.filter(|p| p.age &lt;= 16);
let adults = passengers.filter(|p| p.age &gt; 16 &amp;&amp; p.age &lt;= 60);
let elderly = passengers.filter(|p| p.age &gt; 60);

let child_survivors = children.filter(|p| p.survived == 1);
let adult_survivors = adults.filter(|p| p.survived == 1);
let elderly_survivors = elderly.filter(|p| p.survived == 1);

let child_survival_rate = if children.len() &gt; 0 { (child_survivors.len() * 100) / children.len() } else { 0 };
let adult_survival_rate = if adults.len() &gt; 0 { (adult_survivors.len() * 100) / adults.len() } else { 0 };
let elderly_survival_rate = if elderly.len() &gt; 0 { (elderly_survivors.len() * 100) / elderly.len() } else { 0 };

println(f"Age Demographics Survival:");
println(f"Children (≤16): {child_survivors.len()}/{children.len()} survived ({child_survival_rate}%)");
println(f"Adults (17-60): {adult_survivors.len()}/{adults.len()} survived ({adult_survival_rate}%)");
println(f"Elderly (60+): {elderly_survivors.len()}/{elderly.len()} survived ({elderly_survival_rate}%)");
</code></pre>
<h2 id="economic-analysis-fare-and-survival"><a class="header" href="#economic-analysis-fare-and-survival">Economic Analysis: Fare and Survival</a></h2>
<p>Examine the relationship between ticket price and survival:</p>
<pre><code class="language-ruchy">// Fare-based survival analysis
let expensive_tickets = passengers.filter(|p| p.fare &gt; 30.0);
let moderate_tickets = passengers.filter(|p| p.fare &gt;= 15.0 &amp;&amp; p.fare &lt;= 30.0);
let cheap_tickets = passengers.filter(|p| p.fare &lt; 15.0);

let expensive_survivors = expensive_tickets.filter(|p| p.survived == 1);
let moderate_survivors = moderate_tickets.filter(|p| p.survived == 1);
let cheap_survivors = cheap_tickets.filter(|p| p.survived == 1);

println(f"Fare Analysis:");
println(f"Expensive tickets (&gt;£30): {expensive_survivors.len()}/{expensive_tickets.len()} survived");
println(f"Moderate tickets (£15-30): {moderate_survivors.len()}/{moderate_tickets.len()} survived");
println(f"Cheap tickets (&lt;£15): {cheap_survivors.len()}/{cheap_tickets.len()} survived");

// Calculate average fare for survivors vs casualties
let survivor_fares = survivors.map(|p| p.fare);
let casualty_fares = casualties.map(|p| p.fare);

let avg_survivor_fare = survivor_fares.sum() / survivor_fares.len();
let avg_casualty_fare = casualty_fares.sum() / casualty_fares.len();

println(f"Average fares:");
println(f"Survivors: £{avg_survivor_fare:.2f}");
println(f"Casualties: £{avg_casualty_fare:.2f}");
</code></pre>
<p><strong>Economic Insight:</strong> Higher ticket prices often meant better cabin locations and easier lifeboat access.</p>
<h2 id="compound-demographics-gender--class"><a class="header" href="#compound-demographics-gender--class">Compound Demographics: Gender + Class</a></h2>
<p>Analyze the intersection of multiple demographic factors:</p>
<pre><code class="language-ruchy">// Gender and class intersection analysis
let first_class_women = passengers.filter(|p| p.pclass == 1 &amp;&amp; p.sex == "female");
let first_class_men = passengers.filter(|p| p.pclass == 1 &amp;&amp; p.sex == "male");
let third_class_women = passengers.filter(|p| p.pclass == 3 &amp;&amp; p.sex == "female");
let third_class_men = passengers.filter(|p| p.pclass == 3 &amp;&amp; p.sex == "male");

let first_women_survivors = first_class_women.filter(|p| p.survived == 1);
let first_men_survivors = first_class_men.filter(|p| p.survived == 1);
let third_women_survivors = third_class_women.filter(|p| p.survived == 1);
let third_men_survivors = third_class_men.filter(|p| p.survived == 1);

println(f"Intersection Analysis (Gender × Class):");
println(f"1st Class Women: {first_women_survivors.len()}/{first_class_women.len()} survived");
println(f"1st Class Men: {first_men_survivors.len()}/{first_class_men.len()} survived");
println(f"3rd Class Women: {third_women_survivors.len()}/{third_class_women.len()} survived");
println(f"3rd Class Men: {third_men_survivors.len()}/{third_class_men.len()} survived");
</code></pre>
<h2 id="survival-prediction-model"><a class="header" href="#survival-prediction-model">Survival Prediction Model</a></h2>
<p>Build a simple demographic-based predictor:</p>
<pre><code class="language-ruchy">// Simple survival prediction based on demographics
println("Survival Prediction Model:");
println("High survival probability: Female AND (1st or 2nd class)");
println("Medium survival probability: Female AND 3rd class, OR Child");
println("Low survival probability: Male AND Adult");

var correct_predictions = 0;
for passenger in passengers {
    let high_survival = passenger.sex == "female" &amp;&amp; passenger.pclass &lt;= 2;
    let medium_survival = (passenger.sex == "female" &amp;&amp; passenger.pclass == 3) || passenger.age &lt;= 16;
    
    let predicted_survival = high_survival || medium_survival;
    let actual_survival = passenger.survived == 1;
    
    if predicted_survival == actual_survival {
        correct_predictions = correct_predictions + 1;
    }
}

let accuracy = (correct_predictions * 100) / passengers.len();
println(f"Model accuracy: {accuracy}% ({correct_predictions}/{passengers.len()})");
</code></pre>
<h2 id="key-historical-insights"><a class="header" href="#key-historical-insights">Key Historical Insights</a></h2>
<ol>
<li><strong>Gender Protocol</strong>: “Women and children first” was largely followed</li>
<li><strong>Class Privilege</strong>: Higher passenger class meant better survival chances</li>
<li><strong>Age Matters</strong>: Children had preferential treatment in evacuation</li>
<li><strong>Economic Access</strong>: Higher fares correlated with better cabin locations</li>
<li><strong>Compound Effects</strong>: First-class women had the highest survival rates</li>
</ol>
<h2 id="ethical-considerations"><a class="header" href="#ethical-considerations">Ethical Considerations</a></h2>
<p>This analysis reveals how social hierarchies influenced survival in crisis situations. The data shows systematic inequities that reflected early 20th-century social structures.</p>
<h2 id="next-steps"><a class="header" href="#next-steps">Next Steps</a></h2>
<ul>
<li>Explore the <a href="../../demos/repl/08-data-science/titanic_survival_demo.ruchy">full Titanic demo</a></li>
<li>Learn about <a href="ch08-03-visualization.html">regression with Boston housing</a></li>
<li>Master <a href="ch08-04-correlation.html">feature correlation with wine quality</a></li>
</ul>
<hr />
<p><strong>Complete Demo File:</strong> <a href="../../demos/repl/08-data-science/titanic_survival_demo.ruchy"><code>titanic_survival_demo.ruchy</code></a></p>
<p><em>Every code snippet is tested and verified working. Copy-paste directly into your Ruchy REPL.</em></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="ch08-01-statistics.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="ch08-03-visualization.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="ch08-01-statistics.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="ch08-03-visualization.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="ace.js"></script>
        <script src="mode-rust.js"></script>
        <script src="editor.js"></script>
        <script src="theme-dawn.js"></script>
        <script src="theme-tomorrow_night.js"></script>

        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="book/theme/highlight-ruchy.js"></script>



    </div>
    </body>
</html>
